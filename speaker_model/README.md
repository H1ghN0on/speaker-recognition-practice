**Часть 3. Построение дикторских моделей и их сравнение.**
Дикторская модель строится на основе ранее полученных акустических характеристик.

Эмбеддинг - это способ преобразования чего-то абстрактного, например слов или изображений в набор чисел и векторов.

Дикторский эмбеддинг -  это высокоуровневый вектор признаков, состоящий, например, из 128, 256 и т.п. значений, содержащий особенности голоса конкретного человека.

Дикторский эмбеддинг подразделяется на эталонный эмбеддинг и тестовый эмбеддинг.

Эталонные эмбеддинги формируются на этапе регистрации дикторской модели определённого человека и находятся в некотором хранилище данных. 

Тестовые эмбеддинги формируются на этапе непосредственного использования системы голосовой биометрии на практике, когда некоторый пользователь пытается получить доступ к соответствующим ресурсам. 

После того, как акустические признаки подготовлены, они могут быть переданы в блок построения дикторских моделей.
Для построения дикторской модели используются x-векторные архитектуры.
Они состоят из 4 уровней:
1. Фреймовый - предназначен для формирования локальных представлений голоса конкретного человека.
   
   Обычно используются сверточные нейросети. Выходом фреймового уровня является набор высокоуровневых представлений (карт признаков), содержащих локальные особенности голоса человека.
2. Статистический пуллинг - формирует промежуточный вектор признаков фиксированной длины. Эта длина является одинаковой для звукозаписи любой длительности.
  
   В ходе работы блока статистического пулинга происходит удаление временной размерности, присутствующей в картах признаков.

   Выходом уровня статистического пулинга являются вектор среднего и вектор среднеквадратического отклонения, вычисленные на основе карт признаков. Эти вектор конкантенируются.
   
3. Сегментный уровень - предназначен для трансформации промежуточного вектора, как правило, высокой размерности, в компактный вектор признаков, представляющий собойдикторский эмбеддинг.

   На сегментном уровне расположены один или несколько полносвязных нейросетевых слоёв, а обработка данных выполняется по отношению ко всей звукозаписи, а не только по отношению к некоторому её локальному контексту, как на фреймовом уровне.
4. Выходной слой - представляет полносвязный слой с softmax-функциями активации

   На вход выходного слоя подаётся дикторский эмбеддинг, а на выходе формируется набор апостериорных вероятностей, определяющих принадлежность эмбеддинга к одному из дикторских классов в тренировочной выборке.

   Обучение модели генерации дикторских эмбеддингов выполняется путём решения задачи классификации.

   Функция потерь - категориальная кросс-энтропия.

   Обучение выполняется с помощью мини-батчей, содержащих короткие фрагменты наборов акустических признаков (длительность несколько секунд) различных дикторов из тренировочной базы данных. Обучение на коротких фрагментах позволяет избежать сильного переобучения нейросетевой модели.

   При выполнении процедуры обучения требуется подобрать набор гиперпараметров, выбрать политику обучения и метод численной оптимизации. 

Для того, чтобы увеличить количество элементов выборки для обучения, можно применить аугментацию данных. 

Применение реалистичных методов аугментации к тренировочному множеству позволяет создать набор обучающих данных, с использованием которого можно повысить робастность блока генерации дикторских моделей при наличии шумов и помех.

Можно выделить два режима выполнения аугментации данных: онлайн (применяется в ходе процедуры обучения модели) и оффлайн (применяется до процедуры обучения модели). 

Конкретно в этой работе аугментация данных происходит путем микса аудиозаписей с шумами и аудиозаписей с непосредственно речью. Является онлайн аугментацией.

Так выглядит общая модель для построения дикторских моделей.

![изображение](https://github.com/H1ghN0on/speaker-recognition-practice/assets/65870074/ce93b260-d8dd-4d41-8de6-5a8019d6d691)

Так выглядит гиперпараметры

![изображение](https://github.com/H1ghN0on/speaker-recognition-practice/assets/65870074/b71976b8-0cd7-4513-99fb-76fa9610638e)



   
